{% extends "base.html" %}

{% block title %}Review | Meeting-Cleaner{% endblock %}

{% block content %}

<!-- Back / Status -->
<div class="flex justify-between items-center mb-8">
    <a href="/" class="text-gray-500 hover:text-blue-600 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
             viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Back to Input
    </a>

    <div class="flex items-center gap-2">
        <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full font-bold">Processed</span>
        <span class="px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded-full">ID: #{{ artifact.id }}</span>
    </div>
</div>

<!-- Grid Layout -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-8">

    <!-- LEFT: Raw Transcript -->
    <div class="opacity-75">
        <h3 class="text-xs font-bold uppercase text-gray-400 tracking-wider mb-2">Original Transcript</h3>
        <div class="bg-white p-6 rounded-lg border border-gray-200 h-[600px] overflow-y-auto text-sm leading-relaxed whitespace-pre-wrap font-mono text-gray-600 shadow-sm">
            {{ artifact.raw_transcript }}
        </div>
    </div>

    <!-- RIGHT: Editable AI Output -->
    <div>
        <div class="flex justify-between items-end mb-4">
            <div>
                <h2 class="text-xl font-bold text-gray-900">Unified Review Interface</h2>
                <p class="text-sm text-gray-500">Edit below to align collective understanding.</p>
            </div>
            <div class="text-xs font-mono text-purple-600 bg-purple-50 px-2 py-1 rounded border border-purple-100">
                Technical Context: Active
            </div>
        </div>

        <!-- FORM UPDATED: Method POST, Action points to Export View -->
        <form class="space-y-6" method="post" action="{% url 'export_pdf' artifact.id %}">
            {% csrf_token %}
            <input type="hidden" name="commitments_text" value="{{ artifact.commitments_text }}">
            <input type="hidden" name="deadlines_text" value="{{ artifact.deadlines_text }}">
            <input type="hidden" name="followups_text" value="{{ artifact.followups_text }}">
            
            <!-- Commitments Section -->
            <div class="bg-white rounded-lg border border-l-4 border-l-blue-500 shadow-sm overflow-hidden">
                <div class="bg-gray-50 px-4 py-2 border-b border-gray-200 flex justify-between items-center">
                    <h3 class="font-bold text-blue-900">Commitments</h3>
                    <span class="text-xs text-gray-400">Who is doing what?</span>
                </div>
                <textarea name="commitments_text" class="w-full p-4 text-gray-700 focus:outline-none focus:bg-blue-50 min-h-[120px] resize-y" placeholder="No commitments found...">{{ artifact.commitments_text }}</textarea>
            </div>

            <!-- Deadlines Section -->
            <div class="bg-white rounded-lg border border-l-4 border-l-red-500 shadow-sm overflow-hidden">
                <div class="bg-gray-50 px-4 py-2 border-b border-gray-200 flex justify-between items-center">
                    <h3 class="font-bold text-red-900">Deadlines</h3>
                    <span class="text-xs text-gray-400">Critical Dates</span>
                </div>
                <textarea name="deadlines_text" class="w-full p-4 text-gray-700 focus:outline-none focus:bg-red-50 min-h-[100px] resize-y" placeholder="No deadlines detected...">{{ artifact.deadlines_text }}</textarea>
            </div>

            <!-- Follow-ups / Notes -->
            <div class="bg-white rounded-lg border border-l-4 border-l-amber-500 shadow-sm overflow-hidden">
                <div class="bg-gray-50 px-4 py-2 border-b border-gray-200 flex justify-between items-center">
                    <h3 class="font-bold text-amber-900">General Follow-ups</h3>
                    <span class="text-xs text-gray-400">Context & Next Steps</span>
                </div>
                <textarea name="followups_text" class="w-full p-4 text-gray-700 focus:outline-none focus:bg-amber-50 min-h-[150px] resize-y">{{ artifact.followups_text }}</textarea>
            </div>

            <!-- Action Buttons -->
            <div class="flex gap-4 pt-4">
                <button type="submit" class="flex-1 bg-gray-800 text-white font-bold py-3 rounded-lg hover:bg-gray-900 transition shadow-lg">
                    Finalize & Export PDF
                </button>
                <button type="button" class="px-6 py-3 border border-gray-300 text-gray-600 font-bold rounded-lg hover:bg-gray-50">
                    Share for Approval
                </button>
            </div>                    
        </form>
    </div>
</div>

{% endblock %}

<!-- RIGHT: Actionable Intelligence (Editable) -->
